@using Bazza.Controllers
@model Bazza.ViewModels.Admin.IndexViewModel

<div class="mt-3 mb-6 notification is-warning">Bitte beachte, dass alle Änderungen an Registrierungen oder Artikeln, die du als Administrator machst, auch von der Person, die die Registrierung vorgenommen hat, eingesehen werden kann.</div>

@if (Model.Persons.Any())
{
    <table class="table is-striped is-fullwidth">
        <thead>
        <tr>
            <th style="width: 1px;">ID</th>
            <th>Name</th>
            <th>E-Mail</th>
            <th>Adresse</th>
            <th class="has-text-right" style="width:1px;">Artikel</th>
            <th style="width: 1px;"></th>
            <th style="width: 1px;"></th>
            <th style="width: 1px;"></th>
        </tr>
        </thead>
        <tbody>
        @foreach (var p in Model.Persons)
        {
            <tr>
                <td>@p.Id</td>
                <td>@p.Name</td>
                <td>@p.Email</td>
                <td style="white-space: pre-wrap">@p.Address</td>
                <td class="has-text-right">@p.ArticlesCount</td>
                <td>
                    <form asp-action="@nameof(AdminController.DeletePerson)" asp-route-id="@p.Id">
                        <button type="submit" class="button is-small is-danger is-outlined" onclick="return confirm('Bist du sicher, dass du diese Registrierung löschen möchtest? Du kannst das nicht mehr rückgängig machen!');" title="Löschen">
                            <i class="fad fa-trash"></i>
                        </button>
                    </form>
                </td>
                <td>
                    @if (!p.IsInternal)
                    {
                        <form asp-action="@nameof(AdminController.MakeInternal)" asp-route-id="@p.Id">
                            <button type="submit" class="button is-small is-outlined" onclick="return confirm('Bist du sicher, dass du diese Registrierung als Mütterrunde setzen möchtest?');" title="Als Mütterrunde setzen">
                                <i class="fad fa-arrows-repeat"></i>
                            </button>
                        </form>
                    }
                    else
                    {
                        <form asp-action="@nameof(AdminController.MakeNormal)" asp-route-id="@p.Id">
                            <button type="submit" class="button is-small is-outlined" onclick="return confirm('Bist du sicher, dass du diese Registrierung nicht mehr als Mütterrunde setzen möchtest?');" title="Nicht als Mütterrunde setzen">
                                <i class="fad fa-arrows-cross"></i>
                            </button>
                        </form>
                    }
                </td>
                <td class="has-text-right">
                    <a asp-action="@nameof(HomeController.Register)" asp-controller="Home" asp-route-accessToken="@p.AccessToken" class="button is-outlined is-small" title="Bearbeiten">
                        <i class="fad fa-pencil"></i>
                    </a>
                </td>
            </tr>
        }

        </tbody>
    </table>
}
else
{
    <div class="notification is-danger">Es gibt noch keine Registrierungen.</div>
}

<div class="mt-6">
    <div class="columns">
        <div class="column">
            <a asp-action="@nameof(HomeController.Register)" asp-controller="Home" class="button is-fullwidth is-small">Neue Registrierung</a>
        </div>
        <div class="column">
            <a asp-action="@nameof(AdminController.Download)" class="button is-fullwidth is-small">Excel-Datei herunterladen</a>
        </div>
        <div class="column">
            <a asp-action="@nameof(AdminController.Settings)" class="button is-fullwidth is-small">Einstellungen bearbeiten</a>
        </div>
        <div class="column">
            <form method="post" asp-action="@nameof(AdminController.ClearData)">
                <button type="submit" class="button is-danger is-fullwidth is-small is-outlined" onclick="return confirm('Bist du sicher, dass du alle Registrierungen löschen möchtest? Du kannst das nicht mehr rückgängig machen!');">Alle Daten löschen</button>
                <div class="help">
                    Achtung, das löscht wirklich und dauerhaft alle Registrierungen und Artikel. Diese Funktion nur dann einsetzen, wenn der Basar vorbei ist und alle Daten entfernt werden sollen.
                </div>
            </form>
        </div>
        <div class="column">
            <a asp-action="@nameof(UserController.Logout)" asp-controller="User" class="button is-fullwidth is-small">Ausloggen</a>
        </div>

    </div>

</div>